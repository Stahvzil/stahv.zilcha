(window.webpackJsonpAnnoto=window.webpackJsonpAnnoto||[]).push([[44],{244:function(t,e,n){"use strict";n.r(e),n.d(e,"configure",(function(){return h}));var o=n("aurelia-framework"),i=n("aurelia-event-aggregator"),a=n(62),r=n(31),s=n("app-common/index"),l=function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r},c=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},p=function(){function t(t,e,n,i){this.eventAggregator=t,this.composer=e,this.widgets=n,this.appEl=i,this.map=new WeakMap,this.logger=o.h.getLogger("Annoto-timeline-service")}return t.prototype.init=function(){var t=this;this.widgets.set.forEach((function(e){return t.widgetAttachedHandle(e)})),this.eventAggregator.subscribe(r.a.WIDGET_ATTACHED,(function(e){return t.widgetAttachedHandle(e)})),this.eventAggregator.subscribe(r.a.WIDGET_DETACHED,(function(e){return t.widgetDetachedHandle(e)}))},t.prototype.widgetAttachedHandle=function(t){var e=this;t&&!this.map.get(t)&&t.store.timelineEnabled&&this.composer.compose({viewModel:"timeline/nn-timeline-widget",tagName:"nn-timeline-widget",host:this.appEl.getOriginalParent(),container:t.auContainer}).then((function(n){e.map.set(t,n)})).catch((function(t){e.logger.error(t)}))},t.prototype.widgetDetachedHandle=function(t){var e=this.map.get(t);e&&(this.map.delete(t),this.composer.decompose(e))},t=l([Object(o.t)(i.EventAggregator,a.a,s.WidgetsSet,s.AppElement),c("design:paramtypes",[i.EventAggregator,a.a,s.WidgetsSet,s.AppElement])],t)}();function h(t){t.globalResources("./nn-chart"),t.globalResources("./nn-timeline"),t.globalResources("./nn-progress-bar"),t.globalResources("./nn-timeline-widget"),t.postTask((function(){t.container.get(p).init()}))}},"timeline/chartist/css/chartist.scss":function(t,e,n){"use strict";n.r(e);var o=n(30),i=n.n(o)()((function(t){return t[1]}));i.push([t.i,'.annoto-ct-label{fill:rgba(0,0,0,.4);color:rgba(0,0,0,.4);font-size:.75rem;line-height:1}.annoto-ct-chart-line .annoto-ct-label,.annoto-ct-chart-bar .annoto-ct-label{display:block;display:-webkit-box;display:-ms-flexbox;display:flex}.annoto-ct-label.annoto-ct-horizontal.annoto-ct-start{-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end;-webkit-box-pack:flex-start;-ms-flex-pack:flex-start;justify-content:flex-start;text-align:left;text-anchor:start}.annoto-ct-label.annoto-ct-horizontal.annoto-ct-end{-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;-webkit-box-pack:flex-start;-ms-flex-pack:flex-start;justify-content:flex-start;text-align:left;text-anchor:start}.annoto-ct-label.annoto-ct-vertical.annoto-ct-start{-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end;-webkit-box-pack:flex-end;-ms-flex-pack:flex-end;justify-content:flex-end;text-align:right;text-anchor:end}.annoto-ct-label.annoto-ct-vertical.annoto-ct-end{-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end;-webkit-box-pack:flex-start;-ms-flex-pack:flex-start;justify-content:flex-start;text-align:left;text-anchor:start}.annoto-ct-chart-bar .annoto-ct-label.annoto-ct-horizontal.annoto-ct-start{-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center;text-anchor:start}.annoto-ct-chart-bar .annoto-ct-label.annoto-ct-horizontal.annoto-ct-end{-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;text-align:center;text-anchor:start}.annoto-ct-chart-bar.annoto-ct-horizontal-bars .annoto-ct-label.annoto-ct-horizontal.annoto-ct-start{-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end;-webkit-box-pack:flex-start;-ms-flex-pack:flex-start;justify-content:flex-start;text-align:left;text-anchor:start}.annoto-ct-chart-bar.annoto-ct-horizontal-bars .annoto-ct-label.annoto-ct-horizontal.annoto-ct-end{-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;-webkit-box-pack:flex-start;-ms-flex-pack:flex-start;justify-content:flex-start;text-align:left;text-anchor:start}.annoto-ct-chart-bar.annoto-ct-horizontal-bars .annoto-ct-label.annoto-ct-vertical.annoto-ct-start{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:flex-end;-ms-flex-pack:flex-end;justify-content:flex-end;text-align:right;text-anchor:end}.annoto-ct-chart-bar.annoto-ct-horizontal-bars .annoto-ct-label.annoto-ct-vertical.annoto-ct-end{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:flex-start;-ms-flex-pack:flex-start;justify-content:flex-start;text-align:left;text-anchor:end}.annoto-ct-grid{stroke:rgba(0,0,0,.2);stroke-width:1px;stroke-dasharray:2px}.annoto-ct-point{stroke-width:10px;stroke-linecap:round}.annoto-ct-line{fill:none;stroke-width:4px}.annoto-ct-area{stroke:none;fill-opacity:.1}.annoto-ct-bar{fill:none;stroke-width:12px}.annoto-ct-slice-donut{fill:none;stroke-width:60px}.annoto-ct-series-a .annoto-ct-point,.annoto-ct-series-a .annoto-ct-line,.annoto-ct-series-a .annoto-ct-bar,.annoto-ct-series-a .annoto-ct-slice-donut{stroke:var(--nnc-color-step-450, #717171)}.annoto-ct-series-a .annoto-ct-slice-pie,.annoto-ct-series-a .annoto-ct-area{fill:var(--nnc-color-step-450, #717171)}.annoto-ct-series-b .annoto-ct-point,.annoto-ct-series-b .annoto-ct-line,.annoto-ct-series-b .annoto-ct-bar,.annoto-ct-series-b .annoto-ct-slice-donut{stroke:var(--nnc-color-step-450, #717171)}.annoto-ct-series-b .annoto-ct-slice-pie,.annoto-ct-series-b .annoto-ct-area{fill:var(--nnc-color-step-450, #717171)}.annoto-ct-series-c .annoto-ct-point,.annoto-ct-series-c .annoto-ct-line,.annoto-ct-series-c .annoto-ct-bar,.annoto-ct-series-c .annoto-ct-slice-donut{stroke:var(--nnc-color-step-450, #717171)}.annoto-ct-series-c .annoto-ct-slice-pie,.annoto-ct-series-c .annoto-ct-area{fill:var(--nnc-color-step-450, #717171)}.annoto-ct-series-d .annoto-ct-point,.annoto-ct-series-d .annoto-ct-line,.annoto-ct-series-d .annoto-ct-bar,.annoto-ct-series-d .annoto-ct-slice-donut{stroke:var(--nnc-color-step-450, #717171)}.annoto-ct-series-d .annoto-ct-slice-pie,.annoto-ct-series-d .annoto-ct-area{fill:var(--nnc-color-step-450, #717171)}.annoto-ct-series-e .annoto-ct-point,.annoto-ct-series-e .annoto-ct-line,.annoto-ct-series-e .annoto-ct-bar,.annoto-ct-series-e .annoto-ct-slice-donut{stroke:var(--nnc-color-step-450, #717171)}.annoto-ct-series-e .annoto-ct-slice-pie,.annoto-ct-series-e .annoto-ct-area{fill:var(--nnc-color-step-450, #717171)}.annoto-ct-series-f .annoto-ct-point,.annoto-ct-series-f .annoto-ct-line,.annoto-ct-series-f .annoto-ct-bar,.annoto-ct-series-f .annoto-ct-slice-donut{stroke:var(--nnc-color-step-450, #717171)}.annoto-ct-series-f .annoto-ct-slice-pie,.annoto-ct-series-f .annoto-ct-area{fill:var(--nnc-color-step-450, #717171)}.annoto-ct-series-g .annoto-ct-point,.annoto-ct-series-g .annoto-ct-line,.annoto-ct-series-g .annoto-ct-bar,.annoto-ct-series-g .annoto-ct-slice-donut{stroke:var(--nnc-color-step-450, #717171)}.annoto-ct-series-g .annoto-ct-slice-pie,.annoto-ct-series-g .annoto-ct-area{fill:var(--nnc-color-step-450, #717171)}.annoto-ct-series-h .annoto-ct-point,.annoto-ct-series-h .annoto-ct-line,.annoto-ct-series-h .annoto-ct-bar,.annoto-ct-series-h .annoto-ct-slice-donut{stroke:var(--nnc-color-step-450, #717171)}.annoto-ct-series-h .annoto-ct-slice-pie,.annoto-ct-series-h .annoto-ct-area{fill:var(--nnc-color-step-450, #717171)}.annoto-ct-series-i .annoto-ct-point,.annoto-ct-series-i .annoto-ct-line,.annoto-ct-series-i .annoto-ct-bar,.annoto-ct-series-i .annoto-ct-slice-donut{stroke:var(--nnc-color-step-450, #717171)}.annoto-ct-series-i .annoto-ct-slice-pie,.annoto-ct-series-i .annoto-ct-area{fill:var(--nnc-color-step-450, #717171)}.annoto-ct-series-j .annoto-ct-point,.annoto-ct-series-j .annoto-ct-line,.annoto-ct-series-j .annoto-ct-bar,.annoto-ct-series-j .annoto-ct-slice-donut{stroke:var(--nnc-color-step-450, #717171)}.annoto-ct-series-j .annoto-ct-slice-pie,.annoto-ct-series-j .annoto-ct-area{fill:var(--nnc-color-step-450, #717171)}.annoto-ct-series-k .annoto-ct-point,.annoto-ct-series-k .annoto-ct-line,.annoto-ct-series-k .annoto-ct-bar,.annoto-ct-series-k .annoto-ct-slice-donut{stroke:var(--nnc-color-step-450, #717171)}.annoto-ct-series-k .annoto-ct-slice-pie,.annoto-ct-series-k .annoto-ct-area{fill:var(--nnc-color-step-450, #717171)}.annoto-ct-series-l .annoto-ct-point,.annoto-ct-series-l .annoto-ct-line,.annoto-ct-series-l .annoto-ct-bar,.annoto-ct-series-l .annoto-ct-slice-donut{stroke:var(--nnc-color-step-450, #717171)}.annoto-ct-series-l .annoto-ct-slice-pie,.annoto-ct-series-l .annoto-ct-area{fill:var(--nnc-color-step-450, #717171)}.annoto-ct-series-m .annoto-ct-point,.annoto-ct-series-m .annoto-ct-line,.annoto-ct-series-m .annoto-ct-bar,.annoto-ct-series-m .annoto-ct-slice-donut{stroke:var(--nnc-color-step-450, #717171)}.annoto-ct-series-m .annoto-ct-slice-pie,.annoto-ct-series-m .annoto-ct-area{fill:var(--nnc-color-step-450, #717171)}.annoto-ct-series-n .annoto-ct-point,.annoto-ct-series-n .annoto-ct-line,.annoto-ct-series-n .annoto-ct-bar,.annoto-ct-series-n .annoto-ct-slice-donut{stroke:var(--nnc-color-step-450, #717171)}.annoto-ct-series-n .annoto-ct-slice-pie,.annoto-ct-series-n .annoto-ct-area{fill:var(--nnc-color-step-450, #717171)}.annoto-ct-series-o .annoto-ct-point,.annoto-ct-series-o .annoto-ct-line,.annoto-ct-series-o .annoto-ct-bar,.annoto-ct-series-o .annoto-ct-slice-donut{stroke:var(--nnc-color-step-450, #717171)}.annoto-ct-series-o .annoto-ct-slice-pie,.annoto-ct-series-o .annoto-ct-area{fill:var(--nnc-color-step-450, #717171)}.annoto-ct-square{display:block;position:relative;width:100%}.annoto-ct-square:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:100%}.annoto-ct-square:after{content:"";display:table;clear:both}.annoto-ct-square>svg{display:block;position:absolute;top:0;left:0}.annoto-ct-minor-second{display:block;position:relative;width:100%}.annoto-ct-minor-second:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:93.75%}.annoto-ct-minor-second:after{content:"";display:table;clear:both}.annoto-ct-minor-second>svg{display:block;position:absolute;top:0;left:0}.annoto-ct-major-second{display:block;position:relative;width:100%}.annoto-ct-major-second:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:88.8888888889%}.annoto-ct-major-second:after{content:"";display:table;clear:both}.annoto-ct-major-second>svg{display:block;position:absolute;top:0;left:0}.annoto-ct-minor-third{display:block;position:relative;width:100%}.annoto-ct-minor-third:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:83.3333333333%}.annoto-ct-minor-third:after{content:"";display:table;clear:both}.annoto-ct-minor-third>svg{display:block;position:absolute;top:0;left:0}.annoto-ct-major-third{display:block;position:relative;width:100%}.annoto-ct-major-third:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:80%}.annoto-ct-major-third:after{content:"";display:table;clear:both}.annoto-ct-major-third>svg{display:block;position:absolute;top:0;left:0}.annoto-ct-perfect-fourth{display:block;position:relative;width:100%}.annoto-ct-perfect-fourth:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:75%}.annoto-ct-perfect-fourth:after{content:"";display:table;clear:both}.annoto-ct-perfect-fourth>svg{display:block;position:absolute;top:0;left:0}.annoto-ct-perfect-fifth{display:block;position:relative;width:100%}.annoto-ct-perfect-fifth:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:66.6666666667%}.annoto-ct-perfect-fifth:after{content:"";display:table;clear:both}.annoto-ct-perfect-fifth>svg{display:block;position:absolute;top:0;left:0}.annoto-ct-minor-sixth{display:block;position:relative;width:100%}.annoto-ct-minor-sixth:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:62.5%}.annoto-ct-minor-sixth:after{content:"";display:table;clear:both}.annoto-ct-minor-sixth>svg{display:block;position:absolute;top:0;left:0}.annoto-ct-golden-section{display:block;position:relative;width:100%}.annoto-ct-golden-section:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:61.804697157%}.annoto-ct-golden-section:after{content:"";display:table;clear:both}.annoto-ct-golden-section>svg{display:block;position:absolute;top:0;left:0}.annoto-ct-major-sixth{display:block;position:relative;width:100%}.annoto-ct-major-sixth:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:60%}.annoto-ct-major-sixth:after{content:"";display:table;clear:both}.annoto-ct-major-sixth>svg{display:block;position:absolute;top:0;left:0}.annoto-ct-minor-seventh{display:block;position:relative;width:100%}.annoto-ct-minor-seventh:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:56.25%}.annoto-ct-minor-seventh:after{content:"";display:table;clear:both}.annoto-ct-minor-seventh>svg{display:block;position:absolute;top:0;left:0}.annoto-ct-major-seventh{display:block;position:relative;width:100%}.annoto-ct-major-seventh:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:53.3333333333%}.annoto-ct-major-seventh:after{content:"";display:table;clear:both}.annoto-ct-major-seventh>svg{display:block;position:absolute;top:0;left:0}.annoto-ct-octave{display:block;position:relative;width:100%}.annoto-ct-octave:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:50%}.annoto-ct-octave:after{content:"";display:table;clear:both}.annoto-ct-octave>svg{display:block;position:absolute;top:0;left:0}.annoto-ct-major-tenth{display:block;position:relative;width:100%}.annoto-ct-major-tenth:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:40%}.annoto-ct-major-tenth:after{content:"";display:table;clear:both}.annoto-ct-major-tenth>svg{display:block;position:absolute;top:0;left:0}.annoto-ct-major-eleventh{display:block;position:relative;width:100%}.annoto-ct-major-eleventh:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:37.5%}.annoto-ct-major-eleventh:after{content:"";display:table;clear:both}.annoto-ct-major-eleventh>svg{display:block;position:absolute;top:0;left:0}.annoto-ct-major-twelfth{display:block;position:relative;width:100%}.annoto-ct-major-twelfth:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:33.3333333333%}.annoto-ct-major-twelfth:after{content:"";display:table;clear:both}.annoto-ct-major-twelfth>svg{display:block;position:absolute;top:0;left:0}.annoto-ct-double-octave{display:block;position:relative;width:100%}.annoto-ct-double-octave:before{display:block;float:left;content:"";width:0;height:0;padding-bottom:25%}.annoto-ct-double-octave:after{content:"";display:table;clear:both}.annoto-ct-double-octave>svg{display:block;position:absolute;top:0;left:0}',""]),e.default=i},"timeline/chartist/nn-chartist-chart":function(t,e,n){"use strict";n.r(e),n.d(e,"AnnotoChartistChart",(function(){return l}));var o=n("aurelia-framework"),i=n(167),a=n.n(i),r=function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r},s=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},l=function(){function t(t){this.chart=null,this.element=t}return t.prototype.bind=function(t,e){this.bindEvents()},t.prototype.unbind=function(){this.clearEvents(),this.chart&&(this.chart.detach(),this.chart=null)},t.prototype.propertyChanged=function(t,e,n){this.redraw(),"events"===t&&(this.clearEvents(),this.bindEvents())},t.prototype.redraw=function(){var t=this;this.data&&this.options&&this.type&&this.events&&(this.unbind(),this.chart=a.a[this.type](this.element,this.data,this.options),this.bindEvents(),setTimeout((function(){t.chart&&window.removeEventListener("resize",t.chart.resizeListener)}),0))},t.prototype.bindEvents=function(){if(this.events&&this.chart)for(var t=0;t<this.events.length;t++){var e=this.events[t];this.chart.on(e.type,e.cb)}},t.prototype.clearEvents=function(){if(this.events&&this.chart)for(var t=0;t<this.events.length;t++){var e=this.events[t];this.chart.off(e.type,e.cb)}},r([o.m,s("design:type",Object)],t.prototype,"data",void 0),r([o.m,s("design:type",Object)],t.prototype,"options",void 0),r([o.m,s("design:type",Object)],t.prototype,"type",void 0),r([o.m,s("design:type",Object)],t.prototype,"events",void 0),t=r([Object(o.s)("nn-chartist-chart"),Object(o.t)(o.d.Element),Object(o.u)(),Object(o.w)(!1),s("design:paramtypes",[Object])],t)}()},"timeline/chartist/nn-stacked-bars":function(t,e,n){"use strict";n.r(e),n.d(e,"AnnotoStackedBars",(function(){return h}));var o=n("aurelia-framework"),i=n(167),a=n.n(i),r=n(32),s=n(38),l=n(29),c=function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r},p=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},h=function(){function t(){this.chartData=null,this.config=r.a.chart.stackedBars,this.chartOptions={axisX:{type:a.a.AutoScaleAxis,offset:0,position:"start",labelOffset:{x:0,y:0},showLabel:!1,showGrid:!1,labelInterpolationFnc:a.a.noop,scaleMinSpace:1,onlyInteger:!1},axisY:{offset:0,position:"start",labelOffset:{x:0,y:0},showLabel:!1,showGrid:!1,labelInterpolationFnc:a.a.noop,scaleMinSpace:1,onlyInteger:!0},width:"100%",height:"100%",high:void 0,low:void 0,onlyInteger:!0,chartPadding:{top:0,right:0,bottom:0,left:0},seriesBarDistance:0,stackBars:!0,stackMode:"accumulate",horizontalBars:!1,distributeSeries:!1,reverseData:!1,classNames:{chart:"annoto-ct-chart-bar",horizontalBars:"annoto-ct-horizontal-bars",label:"annoto-ct-label",labelGroup:"annoto-ct-labels",series:"annoto-ct-series",bar:"annoto-ct-bar",grid:"annoto-ct-grid",gridGroup:"annoto-ct-grids",vertical:"annoto-ct-vertical",horizontal:"annoto-ct-horizontal",start:"annoto-ct-start",end:"annoto-ct-end"}},this.chartEvents=[{type:"draw",cb:this.onDraw.bind(this)}]}return t.prototype.activate=function(t){this.chartAPI=t,this.chartAPI.registerDataUpdateCb(this.treeDataChanged.bind(this)),this.chartAPI.registerViewChangedCb(this.viewChanged.bind(this)),this.chartAPI.registerGetMaxResolutionCb(this.getMaxResolution.bind(this))},t.prototype.attached=function(){this.chartAPI.ready()},t.prototype.treeDataChanged=function(t){this.compileData(t)},t.prototype.viewChanged=function(){this.chartVm&&this.chartVm.redraw()},t.prototype.compileData=function(t){var e=this,n=[];if(Object(l.f)(s.a,(function(){n.push([])})),t){var o=this.container.offsetWidth/t.pd,i=this.config.barBoxWidth/o/2,a=this.chartAPI.hasVoteMargin();t.series.forEach((function(r,l){if(!(l>t.pd)){var c=Math.max(0,Math.min(t.pd,l+i)),p=c*o;if(!(a&&e.container.offsetWidth-p<e.config.rightMargin||e.container.offsetWidth-p<e.config.minRightMargin))for(var h=function(t){var e=n[t],o=!1;r.forEach((function(n,i){if(!o&&t===s.a[i]){var a=n.cn+n.vn;e.push({x:c,y:a}),o=!0}})),o||e.push({x:c,y:0})},d=0;d<n.length;d++)h(d)}}));for(var r=0;r<n.length;r++)n[r].unshift({x:0,y:0}),n[r].push({x:t.pd,y:0})}this.applyData(n)},t.prototype.applyData=function(t){0===t.length&&(t.push([]),t[0].push({x:0,y:0})),this.chartData={series:t}},t.prototype.getMaxResolution=function(){if(this.container)return this.container.offsetWidth/this.config.barBoxWidth},t.prototype.onDraw=function(t){if("bar"===t.type){var e=t.axisX.axisLength,n=t.x1,o=this.config.barBoxWidth,i=this.config.barWidth;e-n<o/2&&(i/=2),t.element.attr({style:"stroke-width: "+i+"px;"})}},c([o.m,p("design:type",Object)],t.prototype,"chartData",void 0),c([o.m,p("design:type",Object)],t.prototype,"chartOptions",void 0),c([o.m,p("design:type",Object)],t.prototype,"chartEvents",void 0),c([o.m,p("design:type",Object)],t.prototype,"chartVm",void 0),c([o.m,p("design:type",Object)],t.prototype,"container",void 0),t=c([Object(o.s)("nn-stacked-bars"),p("design:paramtypes",[])],t)}()},"timeline/chartist/nn-stacked-bars.html":function(t,e,n){t.exports='<template>\n  <require from="./css/chartist.scss"></require>\n  <require from="./nn-chartist-chart"></require>\n\n  <div class="annoto-stacked-bars" ref="container">\n    <nn-chartist-chart class="annoto-chartist-chart" view-model.ref="chartVm" type="Bar" data.to-view="chartData"\n                       options.to-view="chartOptions" events.to-view="chartEvents"></nn-chartist-chart>\n  </div>\n</template>\n'},"timeline/css/nn-progress-bar.scss":function(t,e,n){"use strict";n.r(e);var o=n(30),i=n.n(o)()((function(t){return t[1]}));i.push([t.i,".annoto .annoto-progress-bar-container{height:16px;cursor:pointer}.annoto .annoto-progress-bar-container .annoto-progress-bar{height:3px;width:100%;display:block}.annoto .annoto-progress-bar-container .annoto-progress-bar .annoto-progress-line{height:100%}.annoto .annoto-progress-bar-container:hover .annoto-progress-bar{min-height:5px !important}",""]),e.default=i},"timeline/css/nn-timeline-widget.scss":function(t,e,n){"use strict";n.r(e);var o=n(30),i=n.n(o)()((function(t){return t[1]}));i.push([t.i,".annoto-timeline-widget{position:absolute;left:0;visibility:visible;-webkit-box-sizing:border-box;box-sizing:border-box}.annoto-timeline-widget.not-visible{visibility:hidden !important}",""]),e.default=i},"timeline/css/nn-timeline.scss":function(t,e,n){"use strict";n.r(e);var o=n(30),i=n.n(o)()((function(t){return t[1]}));i.push([t.i,".annoto.annoto-timeline{-webkit-box-sizing:border-box;box-sizing:border-box;top:0;left:0;width:100%;height:100%;position:relative;outline:none}.annoto.annoto-timeline .annoto-chart-organ{display:block;position:relative}.annoto.annoto-timeline .annoto-chart{-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;height:256px;top:0;left:0;-webkit-transition:max-height 0s linear;transition:max-height 0s linear}.annoto.annoto-timeline .annoto-chart .annoto-stacked-bars{width:100%;height:100%}.annoto.annoto-timeline .annoto-chart .annoto-stacked-bars .annoto-chartist-chart{display:block;height:100%;width:100%}.annoto.annoto-timeline .annoto-chart .annoto-stacked-bars .annoto-chartist-chart svg{display:block;height:100%;width:100%}.annoto.annoto-timeline .annoto-chart .annoto-stacked-bars .annoto-chartist-chart svg .annoto-ct-series .annoto-ct-bar{stroke-opacity:.8}.annoto.annoto-timeline .annoto-timeline-vote{position:absolute;right:0;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);margin:auto;min-width:32px}.annoto.annoto-timeline .annoto-timeline-vote .annoto-emotion-selector .annoto-emotion{height:32px;width:32px}.annoto.annoto-timeline .annoto-timeline-vote .annoto-emotion-selector .annoto-emotion:hover .annoto-emotion-container{min-width:26px;height:26px;width:26px;margin:1px}.annoto.annoto-timeline .annoto-timeline-vote .annoto-emotion-selector .annoto-emotion:hover .annoto-emotion-container .annoto-emotion-icon{margin:-1px;width:28px;height:28px;line-height:28px;font-size:28px}.annoto.annoto-timeline .annoto-progress-bar-organ{display:block;position:static}.annoto.annoto-timeline.minimised .annoto-chart{-webkit-transition:max-height .2s linear;transition:max-height .2s linear}",""]),e.default=i},"timeline/nn-chart":function(t,e,n){"use strict";n.r(e),n.d(e,"AnnotoChart",(function(){return f})),n.d(e,"AnnotoChartAPI",(function(){return u}));var o=n("aurelia-framework"),i=n(32),a=n(36),r=n("timeline/nn-timeline"),s=n(29),l=n(67),c=n(40),p=n(44),h=function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r},d=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},f=function(){function t(t,e,n){var o=this;this.bindingEngine=t,this.store=n,this.ready=!1,this.disposables=[],this.graph=e,this.resolution=i.a.thread.defaultChartResolution,this.api=new u((function(){return o.data}),(function(){o.ready=!0,o.viewChangeHandle(),o.updateData(n.metaDataController.chartData)}),(function(){return o.graph.canVote}))}return t.prototype.bind=function(){var t=this,e=this.store,n=this.disposables;n.push(e.metaDataController.on(l.b.CHART_DATA_CHANGE,(function(e){return t.updateData(e)}))),n.push(e.metaDataController.on(l.b.CLEAR,(function(){return t.updateData()}))),n.push(e.metaDataController.on(l.b.INITIALIZED,(function(){e.metaDataController.getChartData().then((function(){t.updateView(),t.updateData(e.metaDataController.chartData)}))}))),n.push(e.threadController.on(c.a.FLOOR_PP_CHANGE,(function(){return t.handleFloorPPChange()}))),n.push(e.player.on(p.b.DURATION_CHANGE,(function(){return t.handledPDChange()}))),n.push(this.bindingEngine.propertyObserver(this.chartElement,"offsetWidth").subscribe((function(){return t.viewChangeHandle()}))),n.push(this.bindingEngine.propertyObserver(this.chartElement,"offsetHeight").subscribe((function(){return t.updateView()})))},t.prototype.unbind=function(){for(var t=0;t<this.disposables.length;t++)this.disposables[t].dispose();this.disposables=[],this.updateData(),this.resolution=void 0,this.ready=!1},t.prototype.handleFloorPPChange=function(){this.store.player.isLive&&this.viewChangeHandle()},t.prototype.handledPDChange=function(){this.store.player.isLive||this.viewChangeHandle(!0)},t.prototype.updateData=function(t){this.ready&&this.data!==t&&(this.data=t,this.api.dataUpdate(t))},t.prototype.updateView=function(){this.ready&&this.api.viewChanged()},t.prototype.minimisedChanged=function(){var t=this;setTimeout((function(){return t.updateView()}),0)},t.prototype.viewChangeHandle=function(t){void 0===t&&(t=!1);var e=this.store;this.ready&&e&&(this.resolution=this.calcResolution(),e.metaDataController.setResolution(this.resolution,t),this.updateView())},t.prototype.calcResolution=function(){var t=this.store,e=this.getMaxResolution(),n=e,o=i.a.thread.minCommentsInterval,a=t.player.pd;Boolean(Object(s.k)(a)&&a>0)&&Object(s.k)(e)&&e>0&&(a/e<o&&(n=Math.floor(a/o)));return Math.max(n,1)},t.prototype.getMaxResolution=function(){var t=this.api.getMaxResolution();return Math.max(1,isNaN(t)?1:t)},Object.defineProperty(t.prototype,"chartHeight",{get:function(){return this.minimised?i.a.timeline.hiddenHeight:this.fullChartHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullChartHeight",{get:function(){return Math.max(this.store.api.timeline.height,i.a.timeline.minHeight)},enumerable:!1,configurable:!0}),h([o.m,d("design:type",Object)],t.prototype,"chartModel",void 0),h([o.m,d("design:type",Object)],t.prototype,"onReady",void 0),h([Object(o.m)({defaultBindingMode:o.n.toView}),d("design:type",Boolean)],t.prototype,"minimised",void 0),h([Object(o.p)("minimised"),d("design:type",Object),d("design:paramtypes",[])],t.prototype,"chartHeight",null),h([Object(o.p)("store.api","store.api.timeline.height"),d("design:type",Object),d("design:paramtypes",[])],t.prototype,"fullChartHeight",null),t=h([Object(o.s)("nn-chart"),Object(o.t)(o.b,r.AnnotoTimeline,a.a),d("design:paramtypes",[o.b,r.AnnotoTimeline,a.a])],t)}(),u=function(){function t(t,e,n){this.onGetData=t,this.onReady=e,this.onHasVoteMargin=n}return t.prototype.registerDataUpdateCb=function(t){this.onDataUpdate=t},t.prototype.registerViewChangedCb=function(t){this.onViewChanged=t},t.prototype.registerGetMaxResolutionCb=function(t){this.onGetMaxResolution=t},t.prototype.getData=function(){if("function"==typeof this.onGetData)return this.onGetData()},t.prototype.ready=function(){if("function"==typeof this.onReady)return this.onReady()},t.prototype.hasVoteMargin=function(){if("function"==typeof this.onHasVoteMargin)return this.onHasVoteMargin()},t.prototype.dataUpdate=function(t){"function"==typeof this.onDataUpdate&&this.onDataUpdate(t)},t.prototype.viewChanged=function(){"function"==typeof this.onViewChanged&&this.onViewChanged()},t.prototype.getMaxResolution=function(){if("function"==typeof this.onGetMaxResolution)return this.onGetMaxResolution()},t}()},"timeline/nn-chart.html":function(t,e){t.exports='<template>\n    <div class="annoto-chart" css="max-height: ${chartHeight}px;" ref="chartElement">\n        <compose view-model.bind="chartModel" model.bind="api"></compose>\n    </div>\n    <slot name="end"></slot>\n</template>'},"timeline/nn-progress-bar":function(t,e,n){"use strict";n.r(e),n.d(e,"AnnotoProgressBar",(function(){return l}));var o=n("aurelia-framework"),i=n("aurelia-templating-resources"),a=n("organs/widget/nn-widget"),r=function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r},s=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},l=function(){function t(t,e,n){this.pd=0,this.pp=0,this.ppp=0,this.disposables=[],this.bindingEngine=t,this.signaler=e,this.widget=n}return t.prototype.bind=function(t,e){var n=this;this.disposables.push(this.bindingEngine.propertyObserver(this.pbElement,"offsetWidth").subscribe((function(){n.updateLine()})))},t.prototype.unbind=function(){for(var t=0;t<this.disposables.length;t++)this.disposables[t].dispose();this.disposables=[],this.ppp=0},t.prototype.pdChanged=function(){this.updateLine()},t.prototype.ppChanged=function(){this.updateLine()},Object.defineProperty(t.prototype,"pbStyle",{get:function(){var t=this.widget.api.timeline.scrubberHeight;return t?{height:t+"px"}:{}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"plColor",{get:function(){return this.widget.api.timeline.scrubberColor},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"plStyle",{get:function(){var t=this.plColor,e={width:this.ppp+"px"};return"string"==typeof t&&(e["background-color"]=t),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pdp",{get:function(){return this.pbElement?this.pbElement.offsetWidth:0},enumerable:!1,configurable:!0}),t.prototype.updateLine=function(){this.pd&&this.pbElement&&(this.ppp=Math.floor(this.pdp*this.pp/this.pd)),this._updateSignal()},t.prototype._updateSignal=function(){this.signaler.signal("annoto-pb-update")},r([o.m,s("design:type",Object)],t.prototype,"pd",void 0),r([o.m,s("design:type",Object)],t.prototype,"pp",void 0),r([Object(o.p)("widget.api","widget.api.timeline","widget.api.timeline.scrubberHeight"),s("design:type",Object),s("design:paramtypes",[])],t.prototype,"pbStyle",null),r([Object(o.p)("widget.api","widget.api.timeline","widget.api.timeline.scrubberColor"),s("design:type",Object),s("design:paramtypes",[])],t.prototype,"plColor",null),r([Object(o.p)("ppp","plColor"),s("design:type",Object),s("design:paramtypes",[])],t.prototype,"plStyle",null),r([Object(o.p)("pbElement.offsetWidth"),s("design:type",Object),s("design:paramtypes",[])],t.prototype,"pdp",null),t=r([Object(o.s)("nn-progress-bar"),Object(o.t)(o.b,i.BindingSignaler,a.AnnotoWidget),s("design:paramtypes",[o.b,i.BindingSignaler,a.AnnotoWidget])],t)}()},"timeline/nn-progress-bar.html":function(t,e,n){t.exports='<template>\n    <require from="./css/nn-progress-bar.scss"></require>\n    <div class="annoto-progress-bar-container">\n        <div class="annoto-progress-bar" ref="pbElement" style.bind="pbStyle">\n            <div\n                class="annoto-progress-line"\n                style.bind="plStyle">\n            </div>\n        </div>\n    </div>\n</template>\n'},"timeline/nn-timeline":function(t,e,n){"use strict";n.r(e),n.d(e,"AnnotoTimeline",(function(){return u}));var o=n("aurelia-framework"),i=n("organs/widget/nn-widget"),a=n(32),r=n(44),s=n(40),l=n(67),c=n(31),p=n(29),h=n(48),d=function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r},f=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},u=function(){function t(t,n){this.minimised=!1,this.hasScrubber=!1,this.pp=0,this.pd=0,this.voteSelector=h.a.createLikeOEmotion(),this.userVoted=!1,this.chartClicked=!1,this.submitting=!1,this.mouseIn=!1,this.isOverlay=!1,this.model="./chartist/nn-stacked-bars",this.disposables=[],this.domEvents=[],this.instanceId=e.instanceCounter,e.instanceCounter++,this.element=t,this.widget=n,this.store=n.store,this.logger=o.h.getLogger("Annoto-timeline"),this.element.style.width="100%"}var e;return e=t,t.prototype.bind=function(){var t=this,e=this.disposables,n=this.store;e.push(n.player.on(r.b.TIME_UPDATE,(function(){return t.updatePParams()}))),e.push(n.player.on(r.b.SEEK,(function(){return t.updatePParams()}))),e.push(n.player.on(r.b.READY,(function(){return t.updatePParams()}))),e.push(n.threadController.on(s.a.INITIALIZED,(function(){return t._handleThreadUserVoteUpdate()}))),e.push(n.threadController.on(s.a.VISIBLE_THREAD_VOTE_CHANGE,(function(){return t._handleThreadUserVoteUpdate()}))),n.metaDataController&&e.push(n.metaDataController.on(l.b.VISIBLE_METADATA_CHANGE,(function(e){return t.handleMetaDataChange(e)})))},t.prototype.unbind=function(){for(var t=0;t<this.disposables.length;t++)this.disposables[t].dispose();this.disposables=[],this.pp=0,this.pd=0,this.userVoted=!1,this.userVote=void 0,this.userEmotion=null,this.chartClicked=!1,this.submitting=!1},t.prototype.activate=function(t){t&&(this.isOverlay=t.isOverlay)},t.prototype.attached=function(){var t=this,e={n:"mouseover",f:this.mouseEnter.bind(this)};this.timelineElement.addEventListener(e.n,e.f),this.domEvents.push(e),e={n:"mouseleave",f:this.mouseLeave.bind(this)},this.timelineElement.addEventListener(e.n,e.f),this.domEvents.push(e),this.store.eventAggregator.publish(c.a.TIMELINE_ATTACHED,this),setTimeout((function(){return t.updateHideState()}))},t.prototype.detached=function(){for(var t=0;t<this.domEvents.length;t++)this.timelineElement.removeEventListener(this.domEvents[t].n,this.domEvents[t].f);this.domEvents=[],this.mouseLeaveTimer&&(clearTimeout(this.mouseLeaveTimer),this.mouseLeaveTimer=0),this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=0),this.store.eventAggregator.publish(c.a.TIMELINE_DETTACHED,this)},Object.defineProperty(t.prototype,"showScrubber",{get:function(){return this.hasScrubber=Boolean(!this.store.player.isLive&&(!this.isOverlay||this.store.player.scrubberOnInOverlay)),this.hasScrubber},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canVote",{get:function(){return this.store.settings.threadVoteEnabled},enumerable:!1,configurable:!0}),t.prototype._handleThreadUserVoteUpdate=function(){var t=this.store.threadController.visibleUserVote;t!==this.userVote&&(this.userVote=t,this.userVoted=!!t,this.userEmotion=t?h.a.createEmotionFromVote(t,this.store.settings):null)},t.prototype.handleMetaDataChange=function(t){var e=this;if(this.chartClicked&&t){this.chartClicked=!1;var n=this.store,o=n.analyticsController;return t.count>0?(n.interactiveController.recordUserAction(),Object(p.p)().then((function(){var i=n.dataCompiler.getDominantEmotion(t.emotions);if(o.recordTimelineInteraction("ugc_tap",{element:"chart",tap_time:Math.floor(n.player.pp),count:t.count,root_count:t.rootCount,emotions:t.emotions,dominant:i},{label:i.emotion,value:t.count}),!e.store.isPhone)return Promise.all([n.interactiveController.setOffAndDoShow(),n.playerUxFilter.pause(n,"timelineUgcTap")]).then((function(){return n.interactiveController.focusOnPP()}))}))):void 0}},t.prototype.updatePParams=function(){var t=this.store.player,e=t.pp,n=t.pd;this.pd=n>0?n:void 0,this.pp=Math.min(e,n)},t.prototype.mouseEnter=function(t){this.mouseIn||(this.mouseIn=!0,this.updateHideState(),this.store.eventAggregator.publish(c.a.UX_EVENT,{name:"timeline:focusin"}))},t.prototype.mouseLeave=function(t){var e=this;this.mouseIn&&(this.mouseIn=!1,this.mouseLeaveTimer=setTimeout((function(){e.mouseLeaveTimer=0,e.updateHideState(),e.store.eventAggregator.publish(c.a.UX_EVENT,{name:"timeline:focusout"})}),100))},Object.defineProperty(t.prototype,"shouldHide",{get:function(){return this.isOverlay&&!this.mouseIn},enumerable:!1,configurable:!0}),t.prototype.updateHideState=function(){var t=this;if(!this.shouldHide)return this.maximize(),void(this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=0));this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=0),this.minimised||(this.hideTimer=setTimeout((function(){t.hideTimer=0,t.shouldHide&&t.minimize()}),a.a.timeline.hideTimeout))},t.prototype.minimize=function(){this.minimised||(this.minimised=!0,this.store.eventAggregator.publish(c.a.UX_EVENT,{name:"timeline:hide"}))},t.prototype.maximize=function(){this.minimised&&(this.minimised=!1,this.store.eventAggregator.publish(c.a.UX_EVENT,{name:"timeline:show"}))},t.prototype.chartClick=function(t){var e,n=this;this.widget.ctaActive||this.tapHandle(t,this.chartElement).then((function(t){if(e=t,Object(p.k)(e))return n.store.isLive?n.store.interactiveController.setOffAndDoShow().then((function(){return n.store.interactiveController.focusOnPP(e)})).then((function(){return null})):(n.chartClicked=!0,Object(p.c)(300).then((function(){return n.store.threadController.forceRtModerate()})))})).then((function(){if(Object(p.k)(e))return n.recordTapInteraction(e,"chart")}))},t.prototype.pbClick=function(t){var e=this;this.tapHandle(t,this.pbElement).then((function(t){if(Object(p.k)(t))return e.recordTapInteraction(t,"progress_bar")}))},t.prototype.tapHandle=function(t,e){var n=this;return Promise.resolve().then((function(){if(!n.widget.ctaActive){var o=n.calculatePointInTime(t,e);if(n.chartClicked=!1,Object(p.k)(o))return n.store.playerUxFilter.setCurrentTime(n.store,o).then((function(){return o}))}}))},t.prototype.recordTapInteraction=function(t,e){return this.store.analyticsController.recordTimelineInteraction("tap",{element:e,tap_time:Math.floor(t)},{label:e,value:"chart"===e?1:0})},t.prototype.calculatePointInTime=function(t,e){if(e&&e.offsetWidth>0){var n=e.offsetWidth;return t.offsetX*(this.pd/n)}return!1},t.prototype.submitVote=function(t){var e=this,n=this.store;if(!this.submitting)return this.submitting=!0,n.user.authenticated?n.threadController.postVote(t).then((function(){e.submitting=!1})):(this.submitting=!1,this.store.analyticsController.recordConversionInteraction("auth_trigger",{cause:"thread_vote",element:"timeline",vote:t.info},{label:"thread_vote"}),n.pubSub.publish(c.a.PAGES_SHOW,{page:"auth",frame:"welcome"}))},t.prototype.voteSelectorClickHandle=function(t){var e=this;if(!this.voteVm.isOpen)return this.emotionsBoxVm&&this.emotionsBoxVm.reset(),this.voteVm.open(),void(t&&setTimeout((function(){return e.voteVm.setFocusOnMenu()}),0));var n=h.a.createLikeEmotion(),o=h.a.createVoteFromEmotion(n,this.store.user.author);return this.submitVote(o)},t.instanceCounter=0,d([Object(o.m)({defaultBindingMode:o.n.fromView}),f("design:type",Boolean)],t.prototype,"minimised",void 0),d([Object(o.m)({defaultBindingMode:o.n.fromView}),f("design:type",Boolean)],t.prototype,"hasScrubber",void 0),d([Object(o.p)("store.player","store.player.isLive","store.player.scrubberOnInOverlay"),f("design:type",Object),f("design:paramtypes",[])],t.prototype,"showScrubber",null),d([Object(o.p)("store.settings","store.settings.threadVoteEnabled"),f("design:type",Object),f("design:paramtypes",[])],t.prototype,"canVote",null),t=e=d([Object(o.s)("nn-timeline"),Object(o.t)(o.d.Element,i.AnnotoWidget),f("design:paramtypes",[Object,i.AnnotoWidget])],t)}()},"timeline/nn-timeline-widget":function(t,e,n){"use strict";n.r(e),n.d(e,"AnnotoTimelineWidget",(function(){return h}));var o=n("aurelia-framework"),i=n(32),a=n(29),r=n(44),s=n(36),l=n(62),c=function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r},p=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},h=function(){function t(t,e,n,i,a){this.playerContainerMarginBottom=0,this.bindDisposables=[],this.disposables=[],this.trackMargins={left:0,right:0},this.element=t,this.bindingEngine=e,this.store=n,this.composer=i,this.auContainer=a,this.logger=o.h.getLogger("Annoto-timeline-widget"),this.element.style.position="relative",this.element.style.width="0",this.element.style.height="0",this.element.style.bottom="0",this.element.style.top="auto",this.element.style.left="0",this.element.style.zIndex=n.settings.zIndex.toString()}return t.prototype.bind=function(){var t=this;this.bindDisposables.push(this.store.player.on(r.b.READY,(function(){return t.setup()}))),this.bindDisposables.push(this.store.player.on(r.b.ADAPTOR_REMOVE,(function(){return t.cleanup()})))},t.prototype.unbind=function(){for(var t=0;t<this.bindDisposables.length;t++)this.bindDisposables[t]&&this.bindDisposables[t].dispose();this.bindDisposables=[],this.cleanup()},Object.defineProperty(t.prototype,"isOverlayVideo",{get:function(){return this.store.api.timeline.overlayVideo},enumerable:!1,configurable:!0}),t.prototype.setup=function(){var t=this.store;return this.cleanup(),t.player.fullScreen()||this.isOverlayVideo?this.injectInPlayerControls():this.injectInDock()},t.prototype.cleanup=function(){for(var t=0;t<this.disposables.length;t++)this.disposables[t]&&this.disposables[t].dispose();this.disposables=[],this.composerController&&(this.composer.decompose(this.composerController),this.composerController=null),this.dettachDock(),this.trackMargins={left:0,right:0}},t.prototype.injectInDock=function(){var t=this;if(this.attachDock(),this.dock){var e=this.store;this.composer.compose({viewModel:"timeline/nn-timeline",tagName:"nn-timeline",host:this.dock,container:this.auContainer,model:{isOverlay:!1}}).then((function(n){if(t.composerController=n,e.player.fullScreen())return t.setup();t.disposables.push(e.player.on(r.b.FULL_SCREEN_CHANGE,(function(){if(e.player.fullScreen())return t.setup();t.updateDockSize()}))),t.disposables.push(e.player.on(r.b.SIZE_CHANGE,(function(){t.updateDockSize()}))),t.updateDockSize()})).catch((function(e){t.logger.error(e)}))}},t.prototype.injectInPlayerControls=function(){var t=this,e=this.store,n=e.player.controlsElement();if(!n)return this.injectOverlayFallback();this.composer.compose({viewModel:"timeline/nn-timeline",tagName:"nn-timeline",host:n,container:this.auContainer,model:{isOverlay:!0},firstChildOfHost:!0}).then((function(n){if(t.composerController=n,!t.isOverlayVideo&&!e.player.fullScreen())return t.setup();t.disposables.push(e.player.on(r.b.FULL_SCREEN_CHANGE,(function(){if(!t.isOverlayVideo&&!e.player.fullScreen())return t.setup()})))})).catch((function(e){t.logger.error(e)}))},t.prototype.attachDock=function(){var t=document.createElement("DIV");t.className="annoto-timeline-dock";var e=this.store.player.element,n=window.getComputedStyle(e),o=e.parentElement,i=window.getComputedStyle(o),a=e;if("static"===n.position||"relative"===n.position)a=e;else{var r=["relative","absolute"];for("absolute"!==n.position&&r.push("static");;){if(-1!==r.indexOf(i.position)&&n.height===i.height||a.offsetHeight===o.offsetHeight){a=o;break}if(!(o=o.parentElement))break;i=window.getComputedStyle(o)}}var s=window.getComputedStyle(a);"static"===s.position||"relative"===s.position?a.parentElement?(t.style.float=s.float,this.playerContainerMarginBottom=parseInt(window.getComputedStyle(a.parentElement).marginBottom),a.parentElement.insertBefore(t,a.nextSibling),this.dock=t):this.logger.warn("Could not find valid Player element parent for dock"):this.logger.warn("Player element positioning ("+s.position+") is not supported, unable to attach dock")},t.prototype.dettachDock=function(){var t=this.dock;t&&t.parentElement&&(this.store.api.timeline.disableDockPadding||(t.parentElement.style.marginBottom=this.playerContainerMarginBottom+"px"),t.parentElement.removeChild(t)),this.dock=null},t.prototype.updateDockSize=function(){if(this.dock){this.calcTrackMargins();var t=this.store,e=Math.max(t.api.timeline.height,i.a.timeline.minHeight);t.player.isLive||(e+=i.a.timeline.pbHeight);var n=t.player.width();if(n-=2*t.player.videoRatioOffsets().left,this.dock.style.height=e+"px",this.dock.style.width=n+"px",!t.player.fullScreen()&&this.dock.parentElement&&!this.store.api.timeline.disableDockPadding){var o=window.getComputedStyle(t.player.element),a=window.getComputedStyle(this.dock.parentElement),r=parseInt(a.height)-parseInt(o.height),s=parseInt(a.marginBottom);if(r>=0&&r<e){var l=e-r+this.playerContainerMarginBottom;l!==s&&(this.dock.parentElement.style.marginBottom=l+"px")}}}},t.prototype.calcTrackMargins=function(){this.trackMargins.left=this.store.player.trackMarginLeft(),this.trackMargins.right=this.store.player.trackMarginRight()},t.prototype.injectOverlayFallback=function(){var t=this,e=this.store;if(this.widgetElement){this.playerFullScreenFixForOverlay();this.composer.compose({viewModel:"timeline/nn-timeline",tagName:"nn-timeline",host:this.widgetElement,container:this.auContainer,model:{isOverlay:!0}}).then((function(n){if(t.composerController=n,!t.isOverlayVideo&&!e.player.fullScreen())return t.setup();t.updateOverlaySize(),t.updateOverlayPosition(),t.disposables.push(e.player.on(r.b.FULL_SCREEN_CHANGE,(function(){if(t.playerFullScreenFixForOverlay(),!t.isOverlayVideo&&!e.player.fullScreen())return t.setup();t.updateOverlaySize(),t.updateOverlayPosition()}))),t.disposables.push(e.player.on(r.b.SIZE_CHANGE,(function(){t.updateOverlaySize(),t.updateOverlayPosition()}))),t.disposables.push(e.player.onOneTime(r.b.FIRST_PLAY,(function(){t.updateOverlaySize(),t.updateOverlayPosition()}))),t.disposables.push(e.player.on(r.b.CONTROLS_SHOW,(function(){t.calcTrackMargins(),t.updateOverlayPosition(e.player.cdTransitions.showTiming)}))),t.disposables.push(e.player.on(r.b.CONTROLS_HIDE,(function(){t.updateOverlayPosition(e.player.cdTransitions.hideTiming)}))),t.disposables.push(e.player.on(r.b.CONTROLS_SIZE_CHANGE,(function(){t.calcTrackMargins(),t.updateOverlayPosition()})))})).catch((function(e){t.logger.error(e)}))}},t.prototype.updateOverlaySize=function(){if(this.widgetElement){this.calcTrackMargins();var t=this.store.player.width();t-=this.trackMargins.left+this.trackMargins.right,this.widgetElement.style.width=t+"px"}},t.prototype.updateOverlayPosition=function(t){var e=this.store,n=0,o=0;if(!e.player.fullScreen()){if(!e.player.element)return;var i=Object(a.h)(e.player.element,e.platform.rootElement,this.element);n=i.bottom,o=i.left}var r=e.player.positionBarAtTop(),s=e.player.videoRatioOffsets(),l=e.player.controlsHidden(),c=n+s.top;if(r?c+=e.player.height():l||(c+=e.player.controlsHeight()),t)if(e.player.cdTimeline.fadeInOut){var p=parseInt(t);this.widgetElement.style.transition="visibility 0s linear "+(Object(a.k)(p)?p:0)+"s, opacity "+t}else this.widgetElement.style.transition="bottom "+t;else this.widgetElement.style.transition="none";this.widgetElement.style.left=o+this.trackMargins.left+"px",this.widgetElement.style.bottom=c+"px",this.hidden=l},t.prototype.playerFullScreenFixForOverlay=function(){var t=this.store,e=t.player,n=e.embeddableElement();e.fixFullScreen()&&e.isEmbeddableElement(n)&&(e.fullScreen()?n.appendChild(this.element):t.appCommon.appElement.getOriginalParent().appendChild(this.element))},t=c([Object(o.s)("nn-timeline-widget"),Object(o.t)(o.d.Element,o.b,s.a,l.a,o.c),p("design:paramtypes",[Object,o.b,s.a,l.a,o.c])],t)}()},"timeline/nn-timeline-widget.html":function(t,e,n){t.exports='<template>\n    <require from="./css/nn-timeline-widget.scss"></require>\n\n    <div class="annoto-timeline-widget ${hidden ? \'not-visible\' : \'\'}" ref="widgetElement" aria-hidden="true" tabindex="-1"></div>\n</template>'},"timeline/nn-timeline.html":function(t,e,n){t.exports='<template>\n    <require from="./css/nn-timeline.scss"></require>\n    <require from="../organs/emotion/nn-emotion-vote"></require>\n    <require from="../organs/emotion/nn-emotion"></require>\n    <require from="../organs/emotion/nn-emotions-box"></require>\n\n    <div class="annoto annoto-timeline\n                ${minimised ? \'minimised\' : \'\'}\n                ${store.isPrivateMode ? \'nn-notes-page\' : \'\'}\n                ${isOverlay ? \'nn-overlay\' : \'\'}"\n                ref="timelineElement"\n                aria-hidden="true" tabindex="-1">\n        <nn-chart class="annoto-chart-organ"\n                  if.bind="store.hasUGC"\n                  chart-model.bind="model"\n                  minimised.bind="minimised"\n                  ref="chartElement"\n                  click.trigger="chartClick($event)">\n            <div if.bind="canVote"\n                 slot="end"\n                 show.bind="!minimised"\n                 class="annoto-timeline-vote">\n                <nn-emotion if.bind="userVoted" data.bind="userEmotion"></nn-emotion>\n                <nn-emotion-vote if.bind="!userVoted"\n                                 view-model.ref="voteVm"\n                                 on-vote.call="submitVote(vote)"\n                                 on-selector-click.call="voteSelectorClickHandle(isKb)"\n                                 position="top-left"\n                                 disable-hover.one-time="true">\n                    <nn-emotion slot="emotion-selector"\n                                data.bind="voteSelector"></nn-emotion>\n                    <nn-emotions-box slot="emotions-box"\n                                     view-model.ref="emotionsBoxVm"\n                                     emotions.bind="voteVm.emotions"\n                                     columns.bind="voteVm.columnsNum"\n                                     rows.bind="voteVm.rowsNum"\n                                     on-select.call="voteVm.emotionsBoxSelectHandle(index)"></nn-emotions-box>\n                </nn-emotion-vote>\n            </div>\n        </nn-chart>\n        <nn-progress-bar class="annoto-progress-bar-organ"\n                         if.bind="showScrubber"  \n                         ref="pbElement"\n                         pd.bind="pd"\n                         pp.bind="pp"\n                         click.trigger="pbClick($event)">\n        </nn-progress-bar>\n    </div>\n</template>\n'}}]);